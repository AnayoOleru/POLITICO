'use strict';

var token = window.localStorage.getItem('token');
var payload = JSON.parse(window.atob(token.split('.')[1]));
function verifyToken() {
  if (!token) {
    window.location.href = '/views/sign-in.html';
  }
  // only admin can acess this page
  if (payload.isAdmin == false) {
    window.location.href = '/views/sign-in.html';
  }
  // check if token has expired
}

// Add modal
var openModal = document.getElementById('openmodal');
function openAdd() {
  openModal.style.display = 'block';
}

function closeAdd() {
  openModal.style.display = 'none';
}

// menu
function openNav() {
  document.getElementById('mySidenav').style.width = '200px';
}

function closeNav() {
  document.getElementById('mySidenav').style.width = '0';
}

// Consuming the API admin to get all political offices
document.getElementById('addOffice').addEventListener('submit', addOffice);

function addOffice(e) {
  e.preventDefault();

  var type = document.getElementById('type').value;
  var name = document.getElementById('name').value;
  var result = document.getElementById('result');
  var responseStatus = false;

  fetch('https://trustpolitico.herokuapp.com/api/v1/offices', {
    method: 'POST',
    headers: {
      Accept: 'application/json, text/plain, */*',
      'Content-type': 'application/json',
      'x-access-token': token
    },
    body: JSON.stringify({
      type: type,
      name: name
    })

  }).then(function (res) {
    console.log(res);
    if (res.ok) {
      responseStatus = true;
      result.innerHTML = 'Office successfully created';
      result.style.color = 'white';
    }
    return res.json();
  })
  // Only admin can access the route
  .then(function (res) {
    console.log(res);
    if (!responseStatus) {
      result.innerHTML = res.error;
      result.style.color = 'White';
    }
    if (res.data[0].user.isadmin == true) {
      window.location.href = '/views/signin.html';
    }
  });
}

function getOffice() {
  fetch('https://trustpolitico.herokuapp.com/api/v1/offices', {
    method: 'GET',
    headers: {
      Accept: 'application/json, text/plain, */*',
      'Content-type': 'application/json',
      'x-access-token': token,
      'Access-Control-Allow-Origin': '*'
    }
  }).then(function (res) {
    return res.json();
  }).then(function (data) {
    console.log(data);
    var result = '';
    data.data.forEach(function (office) {
      result += '<div class="box box2">\n                <p class="type">' + office.type + '</p>\n                <p class="people">' + office.name + '</p>\n        </div> ';
    });
    document.getElementById('officeResult').innerHTML = result;
    document.getElementById('username').innerHTML = username;
    document.getElementById('nameside').innerHTML = nameside;
  });
}

getOffice();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL1VJL3NjcmlwdHMvZ292T2ZmaWNlLmpzIl0sIm5hbWVzIjpbInRva2VuIiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCJhdG9iIiwic3BsaXQiLCJ2ZXJpZnlUb2tlbiIsImxvY2F0aW9uIiwiaHJlZiIsImlzQWRtaW4iLCJvcGVuTW9kYWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwib3BlbkFkZCIsInN0eWxlIiwiZGlzcGxheSIsImNsb3NlQWRkIiwib3Blbk5hdiIsIndpZHRoIiwiY2xvc2VOYXYiLCJhZGRFdmVudExpc3RlbmVyIiwiYWRkT2ZmaWNlIiwiZSIsInByZXZlbnREZWZhdWx0IiwidHlwZSIsInZhbHVlIiwibmFtZSIsInJlc3VsdCIsInJlc3BvbnNlU3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQWNjZXB0IiwiYm9keSIsInN0cmluZ2lmeSIsInRoZW4iLCJyZXMiLCJjb25zb2xlIiwibG9nIiwib2siLCJpbm5lckhUTUwiLCJjb2xvciIsImpzb24iLCJlcnJvciIsImRhdGEiLCJ1c2VyIiwiaXNhZG1pbiIsImdldE9mZmljZSIsImZvckVhY2giLCJvZmZpY2UiLCJ1c2VybmFtZSIsIm5hbWVzaWRlIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQU1BLFFBQVFDLE9BQU9DLFlBQVAsQ0FBb0JDLE9BQXBCLENBQTRCLE9BQTVCLENBQWQ7QUFDQSxJQUFNQyxVQUFVQyxLQUFLQyxLQUFMLENBQVdMLE9BQU9NLElBQVAsQ0FBWVAsTUFBTVEsS0FBTixDQUFZLEdBQVosRUFBaUIsQ0FBakIsQ0FBWixDQUFYLENBQWhCO0FBQ0EsU0FBU0MsV0FBVCxHQUF1QjtBQUNyQixNQUFJLENBQUNULEtBQUwsRUFBWTtBQUNWQyxXQUFPUyxRQUFQLENBQWdCQyxJQUFoQixHQUF1QixxQkFBdkI7QUFDRDtBQUNEO0FBQ0EsTUFBSVAsUUFBUVEsT0FBUixJ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QUFTLEVBQWI7QUFDQWlCLFNBQUtBLElBQUwsQ0FBVUksT0FBVixDQUFrQixVQUFDQyxNQUFELEVBQVk7QUFDNUJ0Qiw2RUFFMEJzQixPQUFPekIsSUFGakMsZ0RBRzRCeUIsT0FBT3ZCLElBSG5DO0FBS0QsS0FORDtBQU9BZixhQUFTQyxjQUFULENBQXdCLGNBQXhCLEVBQXdDNEIsU0FBeEMsR0FBb0RiLE1BQXBEO0FBQ0FoQixhQUFTQyxjQUFULENBQXdCLFVBQXhCLEVBQW9DNEIsU0FBcEMsR0FBZ0RVLFFBQWhEO0FBQ0F2QyxhQUFTQyxjQUFULENBQXdCLFVBQXhCLEVBQW9DNEIsU0FBcEMsR0FBZ0RXLFFBQWhEO0FBQ0QsR0F2Qkg7QUF3QkQ7O0FBRURKIiwiZmlsZSI6Imdvdk9mZmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHRva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpO1xuY29uc3QgcGF5bG9hZCA9IEpTT04ucGFyc2Uod2luZG93LmF0b2IodG9rZW4uc3BsaXQoJy4nKVsxXSkpO1xuZnVuY3Rpb24gdmVyaWZ5VG9rZW4oKSB7XG4gIGlmICghdG9rZW4pIHtcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvdmlld3Mvc2lnbi1pbi5odG1sJztcbiAgfVxuICAvLyBvbmx5IGFkbWluIGNhbiBhY2VzcyB0aGlzIHBhZ2VcbiAgaWYgKHBheWxvYWQuaXNBZG1pbiA9PSBmYWxzZSkge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy92aWV3cy9zaWduLWluLmh0bWwnO1xuICB9XG4gIC8vIGNoZWNrIGlmIHRva2VuIGhhcyBleHBpcmVkXG59XG5cbi8vIEFkZCBtb2RhbFxuY29uc3Qgb3Blbk1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5tb2RhbCcpO1xuZnVuY3Rpb24gb3BlbkFkZCgpIHtcbiAgb3Blbk1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xufVxuXG5mdW5jdGlvbiBjbG9zZUFkZCgpIHtcbiAgb3Blbk1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG59XG5cbi8vIG1lbnVcbmZ1bmN0aW9uIG9wZW5OYXYoKSB7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteVNpZGVuYXYnKS5zdHlsZS53aWR0aCA9ICcyMDBweCc7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTmF2KCkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXlTaWRlbmF2Jykuc3R5bGUud2lkdGggPSAnMCc7XG59XG5cblxuLy8gQ29uc3VtaW5nIHRoZSBBUEkgYWRtaW4gdG8gZ2V0IGFsbCBwb2xpdGljYWwgb2ZmaWNlc1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZE9mZmljZScpLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGFkZE9mZmljZSk7XG5cbmZ1bmN0aW9uIGFkZE9mZmljZShlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuXG4gIGNvbnN0IHR5cGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHlwZScpLnZhbHVlO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZTtcbiAgY29uc3QgcmVzdWx0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdCcpO1xuICBsZXQgcmVzcG9uc2VTdGF0dXMgPSBmYWxzZTtcblxuXG4gIGZldGNoKCdodHRwczovL3RydXN0cG9saXRpY28uaGVyb2t1YXBwLmNvbS9hcGkvdjEvb2ZmaWNlcycsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyonLFxuICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICd4LWFjY2Vzcy10b2tlbic6IHRva2VuLFxuICAgIH0sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgdHlwZSxcbiAgICAgIG5hbWUsXG4gICAgfSksXG5cbiAgfSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXNwb25zZVN0YXR1cyA9IHRydWU7XG4gICAgICAgIHJlc3VsdC5pbm5lckhUTUwgPSAnT2ZmaWNlIHN1Y2Nlc3NmdWxseSBjcmVhdGVkJztcbiAgICAgICAgcmVzdWx0LnN0eWxlLmNvbG9yID0gJ3doaXRlJztcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH0pXG4gICAgLy8gT25seSBhZG1pbiBjYW4gYWNjZXNzIHRoZSByb3V0ZVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICBpZiAoIXJlc3BvbnNlU3RhdHVzKSB7XG4gICAgICAgIHJlc3VsdC5pbm5lckhUTUwgPSByZXMuZXJyb3I7XG4gICAgICAgIHJlc3VsdC5zdHlsZS5jb2xvciA9ICdXaGl0ZSc7XG4gICAgICB9XG4gICAgICBpZiAocmVzLmRhdGFbMF0udXNlci5pc2FkbWluID09IHRydWUpIHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL3ZpZXdzL3NpZ25pbi5odG1sJztcbiAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5mdW5jdGlvbiBnZXRPZmZpY2UoKSB7XG4gIGZldGNoKCdodHRwczovL3RydXN0cG9saXRpY28uaGVyb2t1YXBwLmNvbS9hcGkvdjEvb2ZmaWNlcycsIHtcbiAgICBtZXRob2Q6ICdHRVQnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsXG4gICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ3gtYWNjZXNzLXRva2VuJzogdG9rZW4sXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonLFxuICAgIH0sXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgICAgZGF0YS5kYXRhLmZvckVhY2goKG9mZmljZSkgPT4ge1xuICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICArPSBgPGRpdiBjbGFzcz1cImJveCBib3gyXCI+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJ0eXBlXCI+JHtvZmZpY2UudHlwZX08L3A+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJwZW9wbGVcIj4ke29mZmljZS5uYW1lfTwvcD5cbiAgICAgICAgPC9kaXY+IGA7XG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvZmZpY2VSZXN1bHQnKS5pbm5lckhUTUwgPSByZXN1bHQ7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWUnKS5pbm5lckhUTUwgPSB1c2VybmFtZTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lc2lkZScpLmlubmVySFRNTCA9IG5hbWVzaWRlO1xuICAgIH0pO1xufVxuXG5nZXRPZmZpY2UoKTtcbiJdfQ==