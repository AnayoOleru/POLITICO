'use strict';

var token = window.localStorage.getItem('token');
var payload = JSON.parse(window.atob(token.split('.')[1]));
function verifyToken() {
  if (!token) {
    window.location.href = '/views/sign-in.html';
  }
  // only admin can acess this page
  if (payload.isAdmin == false) {
    window.location.href = '/views/sign-in.html';
  }
  // check if token has expired
}

// Add modal
var openModal = document.getElementById('openmodal');
function openAdd() {
  openModal.style.display = 'block';
}

function closeAdd() {
  openModal.style.display = 'none';
}

// menu
function openNav() {
  document.getElementById('mySidenav').style.width = '200px';
}

function closeNav() {
  document.getElementById('mySidenav').style.width = '0';
}

// Consuming the API admin to get all political offices
document.getElementById('addOffice').addEventListener('submit', addOffice);

function addOffice(e) {
  e.preventDefault();

  var type = document.getElementById('type').value;
  var name = document.getElementById('name').value;
  var result = document.getElementById('result');
  var responseStatus = false;

  fetch('https://trustpolitico.herokuapp.com/api/v1/offices', {
    method: 'POST',
    headers: {
      Accept: 'application/json, text/plain, */*',
      'Content-type': 'application/json',
      'x-access-token': token
    },
    body: JSON.stringify({
      type: type,
      name: name
    })

  }).then(function (res) {
    console.log(res);
    if (res.ok) {
      responseStatus = true;
      result.innerHTML = 'Office successfully created';
      result.style.color = 'white';
    }
    return res.json();
  })
  // Only admin can access the route
  .then(function (res) {
    console.log(res);
    if (!responseStatus) {
      result.innerHTML = res.error;
      result.style.color = 'White';
    }
    if (res.data[0].user.isadmin == true) {
      window.location.href = '/views/signin.html';
    }
  });
}

function getOffice() {
  fetch('https://trustpolitico.herokuapp.com/api/v1/offices', {
    method: 'GET',
    headers: {
      Accept: 'application/json, text/plain, */*',
      'Content-type': 'application/json',
      'x-access-token': token,
      'Access-Control-Allow-Origin': '*'
    }
  }).then(function (res) {
    return res.json();
  }).then(function (data) {
    console.log(data);
    var result = '';
    data.data.forEach(function (office) {
      result += '<div class="box box2">\n                <p class="type">' + office.type + '</p>\n                <p class="people">' + office.name + '</p>\n        </div> ';
    });
    document.getElementById('officeResult').innerHTML = result;
    document.getElementById('username').innerHTML = username;
    document.getElementById('nameside').innerHTML = nameside;
  });
}

getOffice();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL1VJL3NjcmlwdHMvZ292T2ZmaWNlLmpzIl0sIm5hbWVzIjpbInRva2VuIiwid2luZG93IiwicGF5bG9hZCIsIkpTT04iLCJvcGVuTW9kYWwiLCJkb2N1bWVudCIsImUiLCJ0eXBlIiwibmFtZSIsInJlc3VsdCIsInJlc3BvbnNlU3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQWNjZXB0IiwiYm9keSIsImNvbnNvbGUiLCJyZXMiLCJkYXRhIiwib2ZmaWNlIiwiZ2V0T2ZmaWNlIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQU1BLFFBQVFDLE9BQUFBLFlBQUFBLENBQUFBLE9BQUFBLENBQWQsT0FBY0EsQ0FBZDtBQUNBLElBQU1DLFVBQVVDLEtBQUFBLEtBQUFBLENBQVdGLE9BQUFBLElBQUFBLENBQVlELE1BQUFBLEtBQUFBLENBQUFBLEdBQUFBLEVBQXZDLENBQXVDQSxDQUFaQyxDQUFYRSxDQUFoQjtBQUNBLFNBQUEsV0FBQSxHQUF1QjtBQUNyQixNQUFJLENBQUosS0FBQSxFQUFZO0FBQ1ZGLFdBQUFBLFFBQUFBLENBQUFBLElBQUFBLEdBQUFBLHFCQUFBQTtBQUNEO0FBQ0Q7QUFDQSxNQUFJQyxRQUFBQSxPQUFBQSxJQUFKLEtBQUEsRUFBOEI7QUFDNUJELFdBQUFBLFFBQUFBLENBQUFBLElBQUFBLEdBQUFBLHFCQUFBQTtBQUNEO0FBQ0Q7QUFDRDs7QUFFRDtBQUNBLElBQU1HLFlBQVlDLFNBQUFBLGNBQUFBLENBQWxCLFdBQWtCQSxDQUFsQjtBQUNBLFNBQUEsT0FBQSxHQUFtQjtBQUNqQkQsWUFBQUEsS0FBQUEsQ0FBQUEsT0FBQUEsR0FBQUEsT0FBQUE7QUFDRDs7QUFFRCxTQUFBLFFBQUEsR0FBb0I7QUFDbEJBLFlBQUFBLEtBQUFBLENBQUFBLE9BQUFBLEdBQUFBLE1BQUFBO0FBQ0Q7O0FBRUQ7QUFDQSxTQUFBLE9BQUEsR0FBbUI7QUFDakJDLFdBQUFBLGNBQUFBLENBQUFBLFdBQUFBLEVBQUFBLEtBQUFBLENB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O0FBd0JEOztBQUVEUyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHRva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpO1xuY29uc3QgcGF5bG9hZCA9IEpTT04ucGFyc2Uod2luZG93LmF0b2IodG9rZW4uc3BsaXQoJy4nKVsxXSkpO1xuZnVuY3Rpb24gdmVyaWZ5VG9rZW4oKSB7XG4gIGlmICghdG9rZW4pIHtcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvdmlld3Mvc2lnbi1pbi5odG1sJztcbiAgfVxuICAvLyBvbmx5IGFkbWluIGNhbiBhY2VzcyB0aGlzIHBhZ2VcbiAgaWYgKHBheWxvYWQuaXNBZG1pbiA9PSBmYWxzZSkge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy92aWV3cy9zaWduLWluLmh0bWwnO1xuICB9XG4gIC8vIGNoZWNrIGlmIHRva2VuIGhhcyBleHBpcmVkXG59XG5cbi8vIEFkZCBtb2RhbFxuY29uc3Qgb3Blbk1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5tb2RhbCcpO1xuZnVuY3Rpb24gb3BlbkFkZCgpIHtcbiAgb3Blbk1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xufVxuXG5mdW5jdGlvbiBjbG9zZUFkZCgpIHtcbiAgb3Blbk1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG59XG5cbi8vIG1lbnVcbmZ1bmN0aW9uIG9wZW5OYXYoKSB7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteVNpZGVuYXYnKS5zdHlsZS53aWR0aCA9ICcyMDBweCc7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTmF2KCkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXlTaWRlbmF2Jykuc3R5bGUud2lkdGggPSAnMCc7XG59XG5cblxuLy8gQ29uc3VtaW5nIHRoZSBBUEkgYWRtaW4gdG8gZ2V0IGFsbCBwb2xpdGljYWwgb2ZmaWNlc1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZE9mZmljZScpLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGFkZE9mZmljZSk7XG5cbmZ1bmN0aW9uIGFkZE9mZmljZShlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuXG4gIGNvbnN0IHR5cGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHlwZScpLnZhbHVlO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZTtcbiAgY29uc3QgcmVzdWx0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdCcpO1xuICBsZXQgcmVzcG9uc2VTdGF0dXMgPSBmYWxzZTtcblxuXG4gIGZldGNoKCdodHRwczovL3RydXN0cG9saXRpY28uaGVyb2t1YXBwLmNvbS9hcGkvdjEvb2ZmaWNlcycsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyonLFxuICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICd4LWFjY2Vzcy10b2tlbic6IHRva2VuLFxuICAgIH0sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgdHlwZSxcbiAgICAgIG5hbWUsXG4gICAgfSksXG5cbiAgfSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXNwb25zZVN0YXR1cyA9IHRydWU7XG4gICAgICAgIHJlc3VsdC5pbm5lckhUTUwgPSAnT2ZmaWNlIHN1Y2Nlc3NmdWxseSBjcmVhdGVkJztcbiAgICAgICAgcmVzdWx0LnN0eWxlLmNvbG9yID0gJ3doaXRlJztcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH0pXG4gICAgLy8gT25seSBhZG1pbiBjYW4gYWNjZXNzIHRoZSByb3V0ZVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICBpZiAoIXJlc3BvbnNlU3RhdHVzKSB7XG4gICAgICAgIHJlc3VsdC5pbm5lckhUTUwgPSByZXMuZXJyb3I7XG4gICAgICAgIHJlc3VsdC5zdHlsZS5jb2xvciA9ICdXaGl0ZSc7XG4gICAgICB9XG4gICAgICBpZiAocmVzLmRhdGFbMF0udXNlci5pc2FkbWluID09IHRydWUpIHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL3ZpZXdzL3NpZ25pbi5odG1sJztcbiAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5mdW5jdGlvbiBnZXRPZmZpY2UoKSB7XG4gIGZldGNoKCdodHRwczovL3RydXN0cG9saXRpY28uaGVyb2t1YXBwLmNvbS9hcGkvdjEvb2ZmaWNlcycsIHtcbiAgICBtZXRob2Q6ICdHRVQnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsXG4gICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ3gtYWNjZXNzLXRva2VuJzogdG9rZW4sXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonLFxuICAgIH0sXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgICAgZGF0YS5kYXRhLmZvckVhY2goKG9mZmljZSkgPT4ge1xuICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICArPSBgPGRpdiBjbGFzcz1cImJveCBib3gyXCI+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJ0eXBlXCI+JHtvZmZpY2UudHlwZX08L3A+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJwZW9wbGVcIj4ke29mZmljZS5uYW1lfTwvcD5cbiAgICAgICAgPC9kaXY+IGA7XG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvZmZpY2VSZXN1bHQnKS5pbm5lckhUTUwgPSByZXN1bHQ7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWUnKS5pbm5lckhUTUwgPSB1c2VybmFtZTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lc2lkZScpLmlubmVySFRNTCA9IG5hbWVzaWRlO1xuICAgIH0pO1xufVxuXG5nZXRPZmZpY2UoKTtcbiJdfQ==